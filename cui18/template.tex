\documentclass[serif,mathserif, 12pt]{beamer}
\usepackage{etex}
\usepackage{amsmath, amsfonts, epsfig, xspace}
\usepackage{algorithm,algorithmic}
\usepackage{pstricks,pst-node}
\usepackage{multimedia}
\usepackage[normal,tight,center]{subfigure}
\setlength{\subfigcapskip}{-.5em}
\usepackage{tkz-euclide}
\usetkzobj{all}
\usepackage{beamerthemesplit}
\usetheme{lankton-keynote}
\input{../preamble.tex}
\usetikzlibrary{matrix}

\newcommand{\BOLD}[1]{\mathbf{#1}}
\newcommand{\BOLDG}[1]{\boldsymbol{#1}}
\newcommand{\PDIF}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\TODO}[1]{\textcolor{red}{#1}}
\newcommand{\TODOB}[1]{\textcolor{blue}{#1}}
\newcommand{\TODOG}[1]{\textcolor{green!50!black}{#1}}
\newcommand{\argmin}{\operatornamewithlimits{arg\min}}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\cond}{cond}
\DeclareMathOperator{\ST}{s.t.}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\Div}{div}
\DeclareMathOperator{\Adv}{Adv}
\DeclareMathOperator{\curl}{curl}

\title[\hspace{2em}\insertframenumber/\inserttotalframenumber]{Scalable Laplacian Eigenfluids}
\date{12th, October 2018}

\author{Theodore Kim et al.}

\makeatletter
\let\@@magyar@captionfix\relax
\makeatother

\begin{document}

\maketitle

\begin{frame}
  \frametitle{Fluid Simulation}
  \begin{itemize}
  \item NS equation
    \[
    \begin{split}
      &\frac{\partial u}{\partial t}+(u\cdot \nabla )u+\frac{1}{\rho}\nabla p
      = f+\nu \Delta u \\
      &\nabla \cdot u = 0
    \end{split}
    \]
   \pause
  \item Discretization method
    \begin{itemize}
    \item[-] Eulerian
    \item[-] Lagrangian
    \item[-] Mixed
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Eulerian method}
  \begin{itemize}
  \item Spatial complexity $O(N^3)$
    \pause
  \item Reduction method?
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Laplacian Eigenfluid [De Witt 2012]}
  \begin{itemize}
  \item Subspace approach
    \[
    u = \sum_{i=1}^r w_i \Psi_i
    \]
  \item Eigenproblem
    \[
    \begin{split}
      &\Delta \Psi_i = \lambda_i \Psi_i \\
      &\nabla \cdot \Psi_i = 0 \\
      &\Psi_i \cdot n = 0, \text{on~} \partial D
    \end{split}
    \]
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Laplacian Eigenfluid}
  \begin{itemize}
  \item On the square domain $[0, \pi]\times [0, \pi]$
    \[
    \begin{split}
    &\Psi_x(k) = -\frac{1}{\sqrt{k_x^2+k_y^2}}k_y\sin(k_x x) \cos(k_y y) \\
      &\Psi_y(k) = \frac{1}{\sqrt{k_x^2+k_y^2}}k_x\cos(k_x x) \sin(k_y y) \\
      &k_x, k_y \in \mathbb{Z}^+
    \end{split} 
    \]
  \end{itemize}
  \TikzDraw {
    \node at (0, -3) {
      \includegraphics[width=\textwidth]{img/eigenmodes}
    };
  }
\end{frame}

\begin{frame}
  \frametitle{Remarks}
  \begin{itemize}
  \item Vorticity bases
    \[
    \begin{split}
    &\phi_i = \nabla \times \Psi_i \\
    &\omega  = \curl u = \sum_{i=1}^r w_i \phi_i
    \end{split}
    \]
  \item Orthogonality
    \[
    \int_D \|u\|^2 = \sum_i w_i^2
    \]
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Dynamics}
  \begin{itemize}
  \item Vorticity formulation of NS equation
    \[
    \begin{split}
      \dot \omega = \Adv(u, \omega) +\nu \Delta \omega + \curl(f) \\
    \end{split}
    \]
    \item Advection
      \[
      \Adv(u, \omega) = \curl(\omega \times u)
      \]
    \item Galerkin projection
      \[
      \begin{split}
        \sum_k \dot w_k \phi_k = \sum_i \sum_j w_i w_j \Adv(\Psi_i, \phi_j) + &\nu \sum_k w_k \Delta \phi_k +\curl(f) \\
        \visible<2> {&\color{red}{\nu \sum_k w_k \lambda_k \phi_k}}
      \end{split}
      \]
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Dynamics}
  \begin{itemize}
  \item Pair with $\phi_k$
    \[
    \dot w_k = \sum_i\sum_j w_i w_j\langle \Adv(\Psi_i, \phi_j),\phi_k\rangle + \nu \lambda_k w_k  + f_k
    \]
    \pause
  \item Time integration
    \begin{figure}
      \centering
      \includegraphics[width=0.6\textwidth]{img/time_integration}
    \end{figure}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Leaving issues}
  \begin{itemize}
  \item Large memory cost $O(rN^3)$
    \pause
  \item Slow evaluation of $Uw$ and $U^Tf$
    \pause
    \begin{itemize}
    \item[-] take up to 84\% of running time
      \pause
    \item[-] Calculate basis on the fly is more slower (5$\times$ to 7$\times$)
      \pause
    \end{itemize}
  \item Only Dirichlet boundary condition is considered
    \pause
  \item Stability of explicit integration
    \pause
  \end{itemize}
\end{frame}

\begin{frame} 
  \TikzDraw {
    \node at (0, 0.5) {\Huge{Results}};
  }
  %\gridlines
\end{frame}

\begin{frame}
  \begin{figure}
    \centering
    \includegraphics[width=\textwidth]{img/teaser}
  \end{figure}
  \TikzDraw {
    \node at (0, 4) {\color{red}{$r=200$}};
    \node at (-3.5, 4) {\color{red}{$r=100$}};
    \node at (3.5, 4) {\color{red}{$r=1000$}};
    \node at (-3.5, 1.2) {\color{red}{$r=2000$}};
    \node at (0, 1.2) {\color{red}{$r=4000$}};
    \node at (3.5, 1.2) {\color{red}{$r=12600$}};
  }
\end{frame}

\begin{frame} 
  \TikzDraw {
    \node at (0, 0.5) {\Huge{Thanks!}};
  }
  %\gridlines
\end{frame}

\end{document}
